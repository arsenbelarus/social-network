(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{101:function(e,t,n){e.exports={main:"MyPosts_main__PN3Os",posts:"MyPosts_posts__1PK4X"}},102:function(e,t,n){e.exports={header:"Header_header__l2oe9",loginBlock:"Header_loginBlock__Zic5-"}},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(23),r=n(24),o=n(26),i=n(25),s=n(0),l=n.n(s),c=n(10),u=n(11),m=function(e){return{isAuth:e.auth.isAuth}},p=function(e){var t=function(t){Object(o.a)(s,t);var n=Object(i.a)(s);function s(){return Object(a.a)(this,s),n.apply(this,arguments)}return Object(r.a)(s,[{key:"render",value:function(){return this.props.isAuth?l.a.createElement(e,this.props):l.a.createElement(c.a,{to:"/login"})}}]),s}(l.a.Component);return Object(u.b)(m)(t)}},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(42),r=n(5),o=function(e){return{type:"ADD-MESSAGE",newMessageBody:e}},i={dialogsData:[{id:1,name:"Arsen"},{id:2,name:"Olya"},{id:3,name:"Tigran"},{id:4,name:"David"}],messagesDataLeft:[{id:1,message:"Hi"},{id:2,message:"How are you"},{id:3,message:"Hello world"},{id:4,message:"Lorem ipsum"}],messagesDataRight:[{id:1,message:"I love my wife"},{id:2,message:"fg gfdgsdfg g fd"},{id:3,message:"fg dfgdf dfg "},{id:4,message:" fd sgdf dfg df "}],newMessageText:""};t.b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD-MESSAGE":var n={id:5,message:t.newMessageBody};return Object(r.a)(Object(r.a)({},e),{},{messagesDataLeft:[].concat(Object(a.a)(e.messagesDataLeft),[n])});default:return e}}},143:function(e,t,n){e.exports=n.p+"static/media/loader.181849d9.gif"},145:function(e,t,n){},150:function(e,t,n){e.exports={item:"Post_item__3YEHT"}},17:function(e,t,n){e.exports={nav:"Navbar_nav__7zjwi",item:"Navbar_item__2dKJe",activeLink:"Navbar_activeLink__3dRIm"}},180:function(e,t,n){e.exports=n(306)},185:function(e,t,n){},186:function(e,t,n){},19:function(e,t,n){e.exports={description:"ProfileInfo_description__1tfyt",formSummaryError:"ProfileInfo_formSummaryError__1aAT3"}},20:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var a=n(103),r=n(0),o=n.n(r),i=n(44),s=n.n(i),l=function(e){var t=e.input,n=e.meta,r=Object(a.a)(e,["input","meta"]),i=n.touched&&n.error;return o.a.createElement("div",{className:s.a.formControl+" "+(i?s.a.error:"")},o.a.createElement("div",null,o.a.createElement("textarea",Object.assign({},t,r))),i&&o.a.createElement("span",null,n.error))},c=function(e){var t=e.input,n=e.meta,r=Object(a.a)(e,["input","meta"]),i=n.touched&&n.error;return o.a.createElement("div",{className:s.a.formControl+" "+(i?s.a.error:"")},o.a.createElement("div",null,o.a.createElement("input",Object.assign({},t,r))),i&&o.a.createElement("span",null,n.error))}},21:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a=function(e){if(!e)return"Field is required"},r=function(e){return function(t){if(t.length>e)return"Max length is ".concat(e," symbols")}}},306:function(e,t,n){"use strict";n.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a=n(0),r=n.n(a),o=n(12),i=n.n(o),s=(n(185),n(23)),l=n(24),c=n(26),u=n(25),m=n(10),p=(n(186),n(17)),f=n.n(p),d=n(14);var g=function(e){return r.a.createElement("div",{className:f.a.nav},r.a.createElement("nav",null,r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/profile",activeClassName:f.a.activeLink}," Profile ")),r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/dialogs",activeClassName:f.a.activeLink}," Messages")),r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/users",activeClassName:f.a.activeLink}," Users")),r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/news",activeClassName:f.a.activeLink}," News")),r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/music",activeClassName:f.a.activeLink}," Music")),r.a.createElement("div",{className:f.a.item},r.a.createElement(d.b,{to:"/settings",activeClassName:f.a.activeLink}," Settings"))))};var E=function(){return r.a.createElement("div",null,"Music")};var h=function(){return r.a.createElement("div",null,"News")};var b=function(){return r.a.createElement("div",null,"Settings")},v=n(11),O=n(42),S=n(5),_=n(142),j=n.n(_).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"a318ecb3-f5df-4512-99ed-aabe354d9b6f"}}),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return j.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},y=function(){return j.get("auth/me").then((function(e){return e.data}))},P=function(e){return j.post("follow/".concat(e),{}).then((function(e){return e.data}))},w=function(e){return j.delete("follow/".concat(e)).then((function(e){return e.data}))},k=function(e){return console.log("Obsolete method. Please use profileApi"),A.getProfile(e)},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return j.get("users?friend=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},A={getProfile:function(e){return j.get("profile/".concat(e))},getStatus:function(e){return j.get("profile/status/".concat(e))},updateStatus:function(e){return j.put("profile/status",{status:e})},updateProfileData:function(e){return j.put("profile",e)},savePhoto:function(e){var t=new FormData;return t.append("image",e),j.put("profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}})}},U=function(e){return j.post("auth/login",e)},T=function(){return j.delete("auth/login")},F=function(){return j.get("security/get-captcha-url")},D={users:[],pageSize:100,totalUsersCount:0,currentPage:1,isFetching:!1,isFollowStatusChanging:[]},L=function(e){return{type:"SET_USERS",users:e}},I=function(e){return{type:"TOGGLE_IS_FETCHING",isFetching:e}},x=function(e,t){return{type:"TOGGLE_FOLLOW_STATUS_CHANGING",isFollowStatusChanging:e,userId:t}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FOLLOW":return Object(S.a)(Object(S.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(S.a)(Object(S.a)({},e),{},{followed:!0}):e}))});case"UNFOLLOW":return Object(S.a)(Object(S.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(S.a)(Object(S.a)({},e),{},{followed:!1}):e}))});case"SET_USERS":return Object(S.a)(Object(S.a)({},e),{},{users:Object(O.a)(t.users)});case"SET_CURRENT_PAGE":return Object(S.a)(Object(S.a)({},e),{},{currentPage:t.currentPage});case"SET_TOTAL_USERS_QUANTITY":return Object(S.a)(Object(S.a)({},e),{},{totalUsersCount:t.totalUsersQuantity});case"TOGGLE_IS_FETCHING":return Object(S.a)(Object(S.a)({},e),{},{isFetching:t.isFetching});case"TOGGLE_FOLLOW_STATUS_CHANGING":return Object(S.a)(Object(S.a)({},e),{},{isFollowStatusChanging:t.isFollowStatusChanging?[].concat(Object(O.a)(e.isFollowStatusChanging),[t.userId]):e.isFollowStatusChanging.filter((function(e){return e!==t.userId}))});default:return e}},R=n(51),G=n.n(R),H=n(46),z=n.n(H),J=n(43),W=n(97),B=n.n(W),Y=function(e){for(var t=Math.ceil(e.totalUsersCount/e.pageSize),n=[],o=1;o<=t;o++)n.push(o);var i=Math.ceil(t/10),s=Object(a.useState)(1),l=Object(J.a)(s,2),c=l[0],u=l[1],m=10*(c-1)+1,p=10*c;return r.a.createElement("div",{className:B.a.pagination},c>1&&r.a.createElement("button",{onClick:function(){u(c-1)}}," Previous "),n.filter((function(e){return e>=m&&e<=p})).map((function(t,n){return r.a.createElement("span",{key:n,className:e.currentPage===t?B.a.selectedPage:"",style:{cursor:"pointer"},onClick:function(){e.onPaginationClickHandler(t)}}," ",t," ")})),i>c&&r.a.createElement("button",{onClick:function(){u(c+1)}}," Next "))},Q=function(e){return r.a.createElement("div",null,r.a.createElement(Y,{totalUsersCount:e.totalUsersCount,pageSize:e.pageSize,currentPage:e.currentPage,onPaginationClickHandler:e.onPaginationClickHandler}),e.users.map((function(t){return r.a.createElement("div",{key:t.id,className:G.a.userContainer},r.a.createElement("div",{className:G.a.imageAndButtonContainer},r.a.createElement("div",null,r.a.createElement(d.b,{to:"/profile/"+t.id},r.a.createElement("img",{src:t.photos.small?t.photos.small:z.a,className:G.a.usersPhoto}))),r.a.createElement("div",{className:G.a.button},t.followed?r.a.createElement("button",{disabled:e.isFollowStatusChanging.some((function(e){return e===t.id})),onClick:function(){return e.unFollow(t.id)}},"UnFollow"):r.a.createElement("button",{disabled:e.isFollowStatusChanging.some((function(e){return e===t.id})),onClick:function(){return e.follow(t.id)}},"Follow"))),r.a.createElement("span",{className:G.a.userInformation},r.a.createElement("span",null,r.a.createElement("div",null,t.name),r.a.createElement("div",null,t.status))))})))},q=n(143),K=n.n(q),Z=function(){return r.a.createElement("div",{style:{width:"100px",margin:"0 auto"}},r.a.createElement("img",{src:K.a,style:{width:"100px",height:"60px"}}))},V=n(9),X=n(144),$=Object(X.a)((function(e){return e.usersPage.users}),(function(e){return e.filter((function(e){return!0}))})),ee=function(e){return e.usersPage.pageSize},te=function(e){return e.usersPage.totalUsersCount},ne=function(e){return e.usersPage.currentPage},ae=function(e){return e.usersPage.isFetching},re=function(e){return e.usersPage.isFollowStatusChanging},oe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onPaginationClickHandler=function(t){e.props.getUsers(t,e.props.pageSize)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.props.isFetching?r.a.createElement(Z,null):null,r.a.createElement(Q,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,follow:this.props.follow,unFollow:this.props.unFollow,isFollowStatusChanging:this.props.isFollowStatusChanging,toggleIsFollowStatusChanging:this.props.toggleIsFollowStatusChanging,onPaginationClickHandler:this.onPaginationClickHandler,users:this.props.users}))}}]),n}(r.a.Component),ie=Object(V.d)(Object(v.b)((function(e){return{users:$(e),pageSize:ee(e),totalUsersCount:te(e),currentPage:ne(e),isFetching:ae(e),isFollowStatusChanging:re(e)}}),{follow:function(e){return function(t){t(x(!0,e)),P(e).then((function(n){0===n.resultCode&&t(function(e){return{type:"FOLLOW",userId:e}}(e)),t(x(!1,e))}))}},toggleFollowStatusChanging:x,getUsers:function(e,t){return function(n){n(I(!0)),n(L([])),n(function(e){return{type:"SET_CURRENT_PAGE",currentPage:e}}(e)),C(e,t).then((function(e){n(I(!1)),n(L(e.items)),n({type:"SET_TOTAL_USERS_QUANTITY",totalUsersQuantity:e.totalCount})}))}},unFollow:function(e){return function(t){t(x(!0,e)),w(e).then((function(n){0===n.resultCode&&t(function(e){return{type:"UNFOLLOW",userId:e}}(e)),t(x(!1,e))}))}}}))(oe),se=n(145),le=n.n(se),ce=n(19),ue=n.n(ce),me=n(334),pe=function(e){var t=Object(a.useState)(!1),n=Object(J.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(e.status),l=Object(J.a)(s,2),c=l[0],u=l[1];Object(a.useEffect)((function(){u(e.status)}),[e.status]);return r.a.createElement(r.a.Fragment,null,!o&&r.a.createElement("div",{className:ue.a.description},r.a.createElement("span",{onDoubleClick:function(){e.isOwner&&i(!0)}},r.a.createElement("strong",null,"Status: "),e.status)),o&&r.a.createElement("div",{className:ue.a.description},r.a.createElement(me.a,{variant:"outlined",type:"text",value:c,onChange:function(e){return u(e.currentTarget.value)},onBlur:function(){i(!1),e.update(c)},autoFocus:!0})))},fe=function(e){return r.a.createElement("div",null,e.isOwner&&r.a.createElement("div",null,r.a.createElement("button",{onClick:e.activateEditMode}," ",r.a.createElement("strong",null," Edit Profile ")," ")),r.a.createElement("div",{className:ue.a.description},r.a.createElement("strong",null," Full name: ")," ",e.profile.fullName),r.a.createElement("div",{className:ue.a.description},r.a.createElement("strong",null," About me: ")," ",e.profile.aboutMe),r.a.createElement("div",{className:ue.a.description},r.a.createElement("strong",null," Looking for a job: ")," ",e.profile.lookingForAJob?"yes":"no"),e.profile.lookingForAJob&&r.a.createElement("div",{className:ue.a.description},r.a.createElement("strong",null," Professional background: ")," ",e.profile.lookingForAJobDescription),r.a.createElement("div",{className:ue.a.description},r.a.createElement("strong",null," Contacts: ")," ",Object.keys(e.profile.contacts).map((function(t){return r.a.createElement("div",{key:t},r.a.createElement("strong",null,t,": ")," ",e.profile.contacts[t])}))))},de=n(20),ge=n(138),Ee=n(139),he=n(21),be=Object(Ee.a)({form:"profileData"})((function(e){return r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("div",null,r.a.createElement("button",null," Save changes"),e.error&&r.a.createElement("div",{className:ue.a.formSummaryError},e.error)),r.a.createElement("div",null,r.a.createElement("p",null,"Full name"),r.a.createElement(ge.a,{type:"text",name:"fullName",component:de.a,placeholder:"Full name",validate:[he.b]})),r.a.createElement("div",null,r.a.createElement("p",null,"Looking for a job"),r.a.createElement(ge.a,{type:"checkbox",name:"lookingForAJob",component:de.a})),r.a.createElement("div",null,r.a.createElement("p",null,"My professional skills"),r.a.createElement(ge.a,{type:"textarea",name:"lookingForAJobDescription",component:de.b,validate:[he.b]})),r.a.createElement("div",null,r.a.createElement("p",null,"About me"),r.a.createElement(ge.a,{type:"textarea",name:"aboutMe",component:de.b,validate:[he.b]})),r.a.createElement("div",null,r.a.createElement("p",null,"Contacts"),Object.keys(e.profile.contacts).map((function(e){return r.a.createElement("div",null,r.a.createElement("strong",null," ",e,": ")," ",r.a.createElement(ge.a,{type:"text",name:"contacts."+e,component:de.a}))}))))})),ve=function(e){var t=e.profile,n=e.status,o=e.update,i=e.isOwner,s=e.savePhoto,l=e.updateProfileData,c=Object(a.useState)(!1),u=Object(J.a)(c,2),m=u[0],p=u[1];return r.a.createElement("div",null,t&&r.a.createElement("div",null,r.a.createElement("div",{className:ue.a.description},r.a.createElement("img",{src:t.photos.large||z.a,alt:"large avatar"}),i&&r.a.createElement("input",{type:"file",onChange:function(e){e.target.files&&e.target.files.length>0&&s(e.target.files[0])}})),m?r.a.createElement(be,{initialValues:t,onSubmit:function(e){l(e).then((function(){return p(!1)}))},profile:t}):r.a.createElement(fe,{isOwner:i,profile:t,activateEditMode:function(){return p(!0)}}),r.a.createElement(pe,{profile:t,status:n,update:o,isOwner:i})))},Oe=n(50),Se=n.n(Oe),_e=n(72),je=n(75),Ce=n(36),ye={profile:null,status:"",postsData:[{id:1,message:"How are you?",likesCount:15},{id:2,message:"It's my first post",likesCount:20},{id:3,message:"I want to learn React",likesCount:35},{id:4,message:"Lorem ipsum",likesCount:1}]},Pe=function(e){return{type:"SET_USER_STATUS",status:e}},we=function(e){return{type:"SET_UPDATED_PROFILE_STATUS",profile:e}},ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD-POST":var n={id:5,message:t.addNewPost,likesCount:0};return Object(S.a)(Object(S.a)({},e),{},{postsData:[].concat(Object(O.a)(e.postsData),[n])});case"DELETE_POST":return Object(S.a)(Object(S.a)({},e),{},{postsData:e.postsData.filter((function(e){return e.id!==t.id}))});case"SET_USERS_PROFILE":return Object(S.a)(Object(S.a)({},e),{},{profile:t.profile});case"SET_USER_STATUS":return Object(S.a)(Object(S.a)({},e),{},{status:t.status});case"SET_USER_PHOTO":return Object(S.a)(Object(S.a)({},e),{},{profile:Object(S.a)(Object(S.a)({},e.profile),{},{photos:t.photos})});case"SET_UPDATED_PROFILE_STATUS":return Object(S.a)(Object(S.a)({},e),{},{profile:Object(S.a)(Object(S.a)({},e.profile),{},{fullName:t.profile.fullName,lookingForAJobDescription:t.profile.lookingForAJobDescription,lookingForAJob:t.profile.lookingForAJob,aboutMe:t.profile.aboutMe,contacts:Object(S.a)({},t.profile.contacts)})});default:return e}},Ne=n(101),Ae=n.n(Ne),Ue=n(150),Te=n.n(Ue);var Fe=function(e){return r.a.createElement("div",{className:Te.a.item},r.a.createElement("img",{src:"https://greendestinations.org/wp-content/uploads/2019/05/avatar-exemple.jpg"}),e.message,r.a.createElement("div",null,r.a.createElement("span",null,e.likesCount,"  likes")))},De=Object(he.a)(10);var Le=Object(Ee.a)({form:"AddPost"})((function(e){return r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("div",null,r.a.createElement(ge.a,{component:de.b,name:"addNewPost",placeholder:"Add your post here",validate:[he.b,De]})),r.a.createElement("div",null,r.a.createElement("button",null,"Add post")))})),Ie=r.a.memo((function(e){var t=e.posts.map((function(e,t){return r.a.createElement(Fe,{key:t,message:e.message,likesCount:e.likesCount})}));return r.a.createElement("div",{className:Ae.a.main},r.a.createElement("h3",null," My posts "),r.a.createElement(Le,{onSubmit:function(t){var n;n=t.addNewPost,e.addPost(n)}}),r.a.createElement("div",{className:Ae.a.posts},"  ",t,"  "))})),xe=Object(v.b)((function(e){return{posts:e.profilePage.postsData}}),(function(e){return{addPost:function(t){e(function(e){return{type:"ADD-POST",addNewPost:e}}(t))}}}))(Ie);var Me=function(e){return r.a.createElement("div",null,r.a.createElement(ve,{profile:e.profile,status:e.status,update:e.update,isOwner:e.isOwner,savePhoto:e.savePhoto,updateProfileData:e.updateProfileData}),r.a.createElement(xe,null))},Re=n(136),Ge=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"goToProfile",value:function(){var e=this.props.match.params.userId;e||(e=this.props.authorisedId)||this.props.history.push("/login"),this.props.getUserProfile(e),this.props.getUserStatus(e)}},{key:"componentDidMount",value:function(){this.goToProfile()}},{key:"componentDidUpdate",value:function(e,t){this.props.match.params.userId!=e.match.params.userId&&this.goToProfile()}},{key:"render",value:function(){return r.a.createElement("div",{className:le.a.content},r.a.createElement(Me,{profile:this.props.profile,status:this.props.status,update:this.props.updateUserStatus,isOwner:!this.props.match.params.userId,savePhoto:this.props.savePhoto,updateProfileData:this.props.updateProfileData}))}}]),n}(r.a.Component),He=Object(V.d)(Re.a,m.f,Object(v.b)((function(e){return{profile:e.profilePage.profile,status:e.profilePage.status,authorisedId:e.auth.id,isAuth:e.auth.isAuth}}),{getUserProfile:function(e){return function(t){k(e).then((function(e){t({type:"SET_USERS_PROFILE",profile:e.data})}))}},getUserStatus:function(e){return function(t){A.getStatus(e).then((function(e){t(Pe(e.data))}))}},updateUserStatus:function(e){return function(t){A.updateStatus(e).then((function(n){0===n.data.resultCode&&t(Pe(e))}))}},savePhoto:function(e){return function(t){A.savePhoto(e).then((function(e){0===e.data.resultCode&&t({type:"SET_USER_PHOTO",photos:e.data.data.photos})}))}},updateProfileData:function(e){return function(){var t=Object(je.a)(Se.a.mark((function t(n){var a,r;return Se.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.updateProfileData(e);case 2:if(0!==(a=t.sent).data.resultCode){t.next=7;break}n(we(e)),t.next=10;break;case 7:return r=a.data.messages[0].match(/Contacts->(\w+)/)[1].toLowerCase(),n(Object(Ce.a)("profileData",{contacts:Object(_e.a)({},r,a.data.messages[0])})),t.abrupt("return",Promise.reject(a.data.messages[0]));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}))(Ge),ze=n(102),Je=n.n(ze);var We=function(e){return r.a.createElement("header",{className:Je.a.header},r.a.createElement("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQie3E0fOUC7Wzjg0m3zZMX44h4RqWOSJqM1cfgO0t2CeE2pmhc&usqp=CAU"}),r.a.createElement("div",{className:Je.a.loginBlock},e.isAuth?r.a.createElement("div",null," ",e.login," --- ",r.a.createElement("button",{onClick:e.logout}," Log out ")," "):r.a.createElement(d.b,{to:"/login"},"Login")))},Be={friends:[]},Ye=function(e){return{type:"SET_FRIENDS",friends:e}},Qe=function(){return function(e){N(!0).then((function(t){e(Ye(t.items))}))}},qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FRIENDS":return Object(S.a)(Object(S.a)({},e),{},{friends:t.friends});default:return e}},Ke={id:null,email:null,login:null,isAuth:!1,captchaUrl:null},Ze=function(e,t,n,a){return{type:"SET_USER_DATA",payload:{id:e,email:t,login:n,isAuth:a}}},Ve=function(e){return{type:"CAPTCHA_URL_SUCCESS",payload:{captchaUrl:e}}},Xe=function(){return function(e){return y().then((function(t){if(0===t.resultCode){var n=t.data,a=n.id,r=n.login,o=n.email;e(Ze(a,o,r,!0))}}))}},$e=function(){return function(e){T().then((function(t){0===t.data.resultCode&&(e(Ze(null,null,null,!1)),e(Ye([])))}))}},et=function(){return function(){var e=Object(je.a)(Se.a.mark((function e(t){var n,a;return Se.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:n=e.sent,a=n.data.url,t(Ve(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_DATA":case"CAPTCHA_URL_SUCCESS":return Object(S.a)(Object(S.a)({},e),t.payload);default:return e}},nt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(We,{isAuth:this.props.isAuth,login:this.props.login,logout:this.props.logout})}}]),n}(r.a.Component),at=Object(v.b)((function(e){return{isAuth:e.auth.isAuth,login:e.auth.login}}),{logout:$e})(nt),rt=n(44),ot=n.n(rt),it=Object(he.a)(10),st=Object(he.a)(50),lt=Object(Ee.a)({form:"login"})((function(e){var t=e.handleSubmit,n=e.error,a=e.captchaUrl;return r.a.createElement("form",{onSubmit:t},r.a.createElement("div",null,r.a.createElement(ge.a,{type:"text",name:"email",component:de.a,placeholder:"email",validate:[he.b,st]})),r.a.createElement("div",null,r.a.createElement(ge.a,{type:"password",name:"password",component:de.a,placeholder:"password",validate:[he.b,it]})),r.a.createElement("div",{style:{display:"inline-flex"}},r.a.createElement(ge.a,{type:"checkbox",name:"rememberMe",component:de.a})," ",r.a.createElement("span",null,"remember me")),a&&r.a.createElement("div",null," ",r.a.createElement("img",{src:a,alt:"Captcha"})," "),a&&r.a.createElement("div",null,r.a.createElement(ge.a,{type:"text",name:"captcha",component:de.a,placeholder:"Type antibot symbols",validate:[he.b]})),n&&r.a.createElement("div",{className:ot.a.formSummaryError},n),r.a.createElement("div",null,r.a.createElement("button",null,"Sign in")))})),ct=Object(v.b)((function(e){return{isAuth:e.auth.isAuth,captchaUrl:e.auth.captchaUrl}}),{login:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return function(r){U({email:e,password:t,rememberMe:n,captcha:a}).then((function(e){if(0===e.data.resultCode)r(Xe()),r(Qe());else{10===e.data.resultCode&&r(et());var t=e.data.messages.length>0?e.data.messages:"Error occurred";r(Object(Ce.a)("login",{_error:"".concat(t)}))}}))}},logout:$e,getCaptcha:et})((function(e){return e.isAuth?r.a.createElement(m.a,{to:"/profile"}):r.a.createElement("div",null,r.a.createElement("h1",null,"LOGIN"),r.a.createElement(lt,{onSubmit:function(t){e.login(t.email,t.password,t.rememberMe,t.captcha)},captchaUrl:e.captchaUrl}))})),ut={initialised:!1},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALISED_SUCCESFULLY":return Object(S.a)(Object(S.a)({},e),{},{initialised:!0});default:return e}},pt=n(77),ft=n.n(pt);var dt=function(e){var t=e.friends.map((function(e,t){return r.a.createElement("div",{className:ft.a.friend,key:t},r.a.createElement(d.b,{to:"/profile/"+e.id},r.a.createElement("img",{src:e.photos.small?e.photos.small:z.a,alt:""})),r.a.createElement("div",{className:ft.a.friendName},e.name))}));return r.a.createElement("div",null,r.a.createElement("h2",null,"Friends"),r.a.createElement("div",{className:ft.a.friends},t))},gt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.getFriends()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(dt,{friends:this.props.friends}))}}]),n}(r.a.Component),Et=Object(v.b)((function(e){return{friends:e.friendsPage.friends}}),{getFriends:Qe})(r.a.memo(gt)),ht=r.a.lazy((function(){return n.e(3).then(n.bind(null,338))})),bt=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.initialiseApp()}},{key:"render",value:function(){return this.props.initialised?r.a.createElement("div",{className:"app-wrapper"},r.a.createElement(at,null),r.a.createElement(g,null),r.a.createElement("div",{className:"app-wrapper-content"},r.a.createElement(m.b,{path:"/profile/:userId?",render:function(){return r.a.createElement(He,null)}}),r.a.createElement(m.b,{path:"/dialogs",render:function(){return r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(Z,null)},r.a.createElement(ht,null))}}),r.a.createElement(m.b,{path:"/news",render:function(){return r.a.createElement(E,null)}}),r.a.createElement(m.b,{path:"/music",render:function(){return r.a.createElement(h,null)}}),r.a.createElement(m.b,{path:"/settings",render:function(){return r.a.createElement(b,null)}}),r.a.createElement(m.b,{path:"/users",render:function(){return r.a.createElement(ie,null)}}),r.a.createElement(m.b,{path:"/login",render:function(){return r.a.createElement(ct,null)}})),r.a.createElement("div",{style:{gridArea:"r",backgroundColor:"black"}},r.a.createElement(Et,null))):r.a.createElement(Z,null)}}]),n}(r.a.Component),vt=Object(v.b)((function(e){return{initialised:e.app.initialised}}),{initialiseApp:function(){return function(e){var t=e(Xe());Promise.all([t]).then((function(){e({type:"INITIALISED_SUCCESFULLY"})}))}}})(bt),Ot=n(137),St=n(151),_t=n(140),jt=Object(V.c)({profilePage:ke,messagesPage:Ot.b,usersPage:M,friendsPage:qe,auth:tt,app:mt,form:_t.a}),Ct=Object(V.e)(jt,Object(V.a)(St.a));i.a.render(r.a.createElement(v.a,{store:Ct},r.a.createElement(d.a,null,r.a.createElement(vt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e,t,n){e.exports={formControl:"FormControls_formControl__ZYcM1",error:"FormControls_error__3I2i7",formSummaryError:"FormControls_formSummaryError__2CIQE"}},46:function(e,t,n){e.exports=n.p+"static/media/avatar.64830c49.jpg"},51:function(e,t,n){e.exports={usersPhoto:"Users_usersPhoto__2cLG_",userContainer:"Users_userContainer__PLg5V",imageAndButtonContainer:"Users_imageAndButtonContainer__3Yr9E",button:"Users_button__2GMTj",userInformation:"Users_userInformation__3W_DY"}},77:function(e,t,n){e.exports={friends:"Friends_friends__22q5d",friend:"Friends_friend__2--Sd",friendName:"Friends_friendName__3AgSy"}},97:function(e,t,n){e.exports={selectedPage:"Paginator_selectedPage__3QJY_",pagination:"Paginator_pagination__1WvrG"}}},[[180,1,2]]]);
//# sourceMappingURL=main.8a09d48e.chunk.js.map